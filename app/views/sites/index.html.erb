<%= render partial: "layouts/nav", locals: {user: @user} %>
<h1>Hello World Home Page</h1>

<div class="col-md-12">
	<div id="map-div" style="width: 1110px; height: 470px; overflow: hidden; border: solid 1px #ccc; margin-bottom: 50px;">
		<!--<img src="assets/sf-map.jpg">-->
	</div>
	<div class="col-md-8">

		<% @posts.each do |post| %> 
		<div class="well">
			<p><%= post.status %></p>
			<p>
			  <strong>Title:</strong>
			  <%= post.title %>
			</p>

			<p>
			  <strong>Description:</strong>
			  <%= post.description %>
			</p>
		</div>
		<% end %>

	</div>
	<div class="col-md-4">
		<div class="well sign-up">
			<p>Lorem Ipsum</p>
			<p>Lorem Ipsum</p>
			<p>Lorem Ipsum</p>
			<p>Lorem Ipsum</p>
			<p>Lorem Ipsum</p>
		</div>
	</div>
</div>
<script type="text/javascript">

function initialize() {
	
	var mapOptions = {
		center: new google.maps.LatLng(37.783333, -122.416667),
		zoom: 14,
		mapTypeId: google.maps.MapTypeId.ROADMAP
	}; // end mapOptions

	var map = new google.maps.Map(document.getElementById('map-div'), mapOptions);

	google.maps.event.addDomListener(window, 'load', initialize);

	var geocoder = new google.maps.Geocoder();

	var addresses =
	   	$.get('/posts.json').
	   	done(function (data) {
	   		console.log("DATA", data);
	   		var addressArray = [];
			// loop through data and get locations
			for(var i = 0; i < data.length; i++) {
				addressArray.push(data[i].location);	
			}
			console.log(addressArray);

			$.each(addressArray, function(index, address1) {
				console.log(index + ": " + address1);
	   			geocoder.geocode({
	      			'address': address1 + " San Francisco, CA"
	   			}, 
	   			function(results, status) {
	      			if(status == google.maps.GeocoderStatus.OK) {
	      				console.log(results);
	         			new google.maps.Marker({
		            		position: results[0].geometry.location,
		            		map: map
	         			});
	         //map.setCenter(results[0].geometry.location);
	     	 		} // end if
	   			}); // end function
			}); // end each
	   	}); // end done

}//end initialize

</script>
